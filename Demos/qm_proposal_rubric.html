<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>QM Proposal — Weighted Scoring Sheet (0–10 Scale)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #f8fafc;
      --card: #ffffff;
      --border: #d0d7e2;
      --accent: #1f4e79;
      --accent-soft: #e1edf7;
      --text: #111827;
      --muted: #4b5563;
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--text);
      margin: 0;
      padding: 1.5rem;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      background: var(--card);
      border-radius: 8px;
      border: 1px solid var(--border);
      padding: 1.5rem 1.75rem 2rem;
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.05);
    }

    h1 {
      font-size: 1.5rem;
      margin-top: 0;
      margin-bottom: 0.25rem;
      color: var(--accent);
    }

    .subtitle {
      font-size: 0.9rem;
      color: var(--muted);
      margin-bottom: 1.25rem;
    }

    h2 {
      font-size: 1.1rem;
      margin-top: 1.5rem;
      margin-bottom: 0.25rem;
      color: var(--accent);
    }

    .section-meta {
      font-size: 0.8rem;
      color: var(--muted);
      margin-bottom: 0.75rem;
    }

    .section-card {
      border-radius: 6px;
      border: 1px solid var(--border);
      padding: 0.75rem 0.75rem 0.5rem;
      margin-bottom: 0.75rem;
      background: #ffffff;
    }

    .crit-row {
      padding: 0.5rem 0.25rem;
      border-bottom: 1px dashed #e5e7eb;
    }

    .crit-row:last-child {
      border-bottom: none;
    }

    .flex-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      align-items: center;
      justify-content: space-between;
    }

    .crit-label {
      flex: 1 1 260px;
      font-size: 0.9rem;
    }

    .crit-label span {
      display: block;
      font-size: 0.8rem;
      color: var(--muted);
      margin-top: 0.15rem;
    }

    .crit-meta {
      text-align: right;
      font-size: 0.8rem;
      color: var(--muted);
      min-width: 150px;
    }

    .crit-meta .weight {
      font-weight: 600;
      color: var(--accent);
      display: block;
    }

    select,
    input[type="text"] {
      font: inherit;
      padding: 0.2rem 0.4rem;
      border-radius: 4px;
      border: 1px solid var(--border);
    }

    select:focus,
    input[type="text"]:focus {
      outline: 2px solid var(--accent-soft);
      outline-offset: 1px;
      border-color: var(--accent);
    }

    .rating-select {
      margin-top: 0.3rem;
      min-width: 140px;
    }

    .notes-input {
      width: 100%;
      margin-top: 0.3rem;
      font-size: 0.8rem;
      padding: 0.25rem 0.35rem;
      border-radius: 4px;
      border: 1px dashed #d1d5db;
      min-height: 2.2rem;
      resize: vertical;
    }

    .scale-hint {
      font-size: 0.75rem;
      color: var(--muted);
      margin-bottom: 0.35rem;
    }

    .title-row {
      margin-bottom: 1rem;
      padding: 0.75rem 0.75rem 0.9rem;
      border-radius: 6px;
      border: 1px solid var(--border);
      background: #ffffff;
    }

    .title-row label {
      display: block;
      font-size: 0.85rem;
      color: var(--muted);
      margin-bottom: 0.25rem;
    }

    .title-row input[type="text"] {
      width: 100%;
    }

    .totals {
      margin-top: 1.25rem;
      padding-top: 1rem;
      border-top: 1px solid var(--border);
      display: grid;
      gap: 0.35rem;
      font-size: 0.95rem;
    }

    .totals-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .total-label {
      font-weight: 500;
      color: var(--muted);
    }

    .total-value {
      font-weight: 600;
      color: var(--accent);
    }

    .final-total {
      margin-top: 0.5rem;
      padding: 0.6rem 0.75rem;
      border-radius: 6px;
      background: var(--accent-soft);
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 0.75rem;
    }

    .final-total strong {
      font-size: 1rem;
    }

    .final-score {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--accent);
    }

    .helper-text {
      font-size: 0.75rem;
      color: var(--muted);
      margin-top: 0.2rem;
    }

    .reset-btn,
    .download-btn {
      margin-top: 0.75rem;
      padding: 0.35rem 0.8rem;
      font-size: 0.8rem;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #f9fafb;
      cursor: pointer;
    }

    .reset-btn:hover,
    .download-btn:hover {
      background: #eef2f7;
    }

    .footer-actions {
      margin-top: 0.5rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      justify-content: flex-start;
      align-items: center;
    }

    @media (max-width: 640px) {
      body {
        padding: 0.75rem;
      }
      .container {
        padding: 1rem 1.1rem 1.5rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>QM Proposal — Weighted Scoring Sheet</h1>
    <p class="subtitle">
      Each dropdown value is the actual weighted contribution for that criterion. The overall score is reported on a 0–10 scale.
    </p>

    <!-- PROPOSAL TITLE -->
    <div class="title-row">
      <label for="proposalTitle">Proposal title or course name</label>
      <input
        type="text"
        id="proposalTitle"
        placeholder="e.g., EPSY 4xx: Online Assessment and Feedback"
      />
    </div>

    <h2>Weighted Criteria</h2>
    <p class="section-meta">
      For each criterion, choose how strongly it is addressed. The value in the dropdown is the number of points (0 up to the weight).
    </p>
    <p class="scale-hint">
      <strong>Scale:</strong> None = 0 · Partial = mid value · Strong = full weight
    </p>

    <div class="section-card">
      <!-- Strategic/College Impact (0–2.0) -->
      <div class="crit-row">
        <div class="flex-row">
          <div class="crit-label">
            <strong>1. Strategic/College Impact</strong>
            <span>
              Does the course have high impact (e.g., high enrollment, Gen Ed, required, foundation, research methods)?
              Is the impact on students, department, and college clearly articulated?
            </span>
          </div>
          <div class="crit-meta">
            <span class="weight">Max value: 2.0</span>
            <label for="critStrategic" class="helper-text">Score (0–2)</label>
            <select id="critStrategic" class="rating-select">
              <option value="2">Strong (2.0)</option>
              <option value="1">Partial (1.0)</option>
              <option value="0">None (0)</option>
            </select>
          </div>
        </div>
        <textarea id="notesStrategic" class="notes-input" placeholder="Notes (optional)"></textarea>
      </div>

      <!-- Alignment to QM Framework (0–2.0) -->
      <div class="crit-row">
        <div class="flex-row">
          <div class="crit-label">
            <strong>2. Alignment to QM Framework</strong>
            <span>
              Does the proposal demonstrate commitment to QM’s eight General Standards, including accessibility and usability?
            </span>
          </div>
          <div class="crit-meta">
            <span class="weight">Max value: 2.0</span>
            <label for="critQM" class="helper-text">Score (0–2)</label>
            <select id="critQM" class="rating-select">
              <option value="2">Strong (2.0)</option>
              <option value="1">Partial (1.0)</option>
              <option value="0">None (0)</option>
            </select>
          </div>
        </div>
        <textarea id="notesQM" class="notes-input" placeholder="Notes (optional)"></textarea>
      </div>

      <!-- Feasibility & Project Plan (0–1.5) -->
      <div class="crit-row">
        <div class="flex-row">
          <div class="crit-label">
            <strong>3. Feasibility &amp; Project Plan</strong>
            <span>
              Is the timeline realistic and aligned with CFP milestones? Are requested supports clear and appropriate?
            </span>
          </div>
          <div class="crit-meta">
            <span class="weight">Max value: 1.5</span>
            <label for="critFeasibility" class="helper-text">Score (0–1.5)</label>
            <select id="critFeasibility" class="rating-select">
              <option value="1.5">Strong (1.5)</option>
              <option value="0.75">Partial (0.75)</option>
              <option value="0">None (0)</option>
            </select>
          </div>
        </div>
        <textarea id="notesFeasibility" class="notes-input" placeholder="Notes (optional)"></textarea>
      </div>

      <!-- Student-Centered Rationale (0–1.0) -->
      <div class="crit-row">
        <div class="flex-row">
          <div class="crit-label">
            <strong>4. Student-Centered Rationale</strong>
            <span>
              Does the proposal explain how QM alignment will improve learner engagement and success?
              Is evidence (e.g., surveys, feedback) provided?
            </span>
          </div>
          <div class="crit-meta">
            <span class="weight">Max value: 1.0</span>
            <label for="critRationale" class="helper-text">Score (0–1)</label>
            <select id="critRationale" class="rating-select">
              <option value="1">Strong (1.0)</option>
              <option value="0.5">Partial (0.5)</option>
              <option value="0">None (0)</option>
            </select>
          </div>
        </div>
        <textarea id="notesRationale" class="notes-input" placeholder="Notes (optional)"></textarea>
      </div>

      <!-- Readiness & Experience (0–1.0) -->
      <div class="crit-row">
        <div class="flex-row">
          <div class="crit-label">
            <strong>5. Readiness &amp; Experience</strong>
            <span>
              Does the proposer have prior experience or training in online course design/QM?
            </span>
          </div>
          <div class="crit-meta">
            <span class="weight">Max value: 1.0</span>
            <label for="critReadiness" class="helper-text">Score (0–1)</label>
            <select id="critReadiness" class="rating-select">
              <option value="1">Strong (1.0)</option>
              <option value="0.5">Partial (0.5)</option>
              <option value="0">None (0)</option>
            </select>
          </div>
        </div>
        <textarea id="notesReadiness" class="notes-input" placeholder="Notes (optional)"></textarea>
      </div>

      <!-- Departmental Support (0–1.0) -->
      <div class="crit-row">
        <div class="flex-row">
          <div class="crit-label">
            <strong>6. Departmental Support</strong>
            <span>
              Is there a strong statement of support from the department head?
            </span>
          </div>
          <div class="crit-meta">
            <span class="weight">Max value: 1.0</span>
            <label for="critDept" class="helper-text">Score (0–1)</label>
            <select id="critDept" class="rating-select">
              <option value="1">Strong (1.0)</option>
              <option value="0.5">Partial (0.5)</option>
              <option value="0">None (0)</option>
            </select>
          </div>
        </div>
        <textarea id="notesDept" class="notes-input" placeholder="Notes (optional)"></textarea>
      </div>

      <!-- Sustainability & Certification Path (0–0.5) -->
      <div class="crit-row">
        <div class="flex-row">
          <div class="crit-label">
            <strong>7. Sustainability &amp; Certification Path</strong>
            <span>
              Does the proposal plan for internal QM review and readiness for external certification?
            </span>
          </div>
          <div class="crit-meta">
            <span class="weight">Max value: 0.5</span>
            <label for="critSustain" class="helper-text">Score (0–0.5)</label>
            <select id="critSustain" class="rating-select">
              <option value="0.5">Strong (0.5)</option>
              <option value="0.25">Partial (0.25)</option>
              <option value="0">None (0)</option>
            </select>
          </div>
        </div>
        <textarea id="notesSustain" class="notes-input" placeholder="Notes (optional)"></textarea>
      </div>

      <!-- Risk & Resource Fit (0–0.5) -->
      <div class="crit-row">
        <div class="flex-row">
          <div class="crit-label">
            <strong>8. Risk &amp; Resource Fit</strong>
            <span>
              Are risks identified and mitigated? Do technology and resource needs align with available support?
            </span>
          </div>
          <div class="crit-meta">
            <span class="weight">Max value: 0.5</span>
            <label for="critRisk" class="helper-text">Score (0–0.5)</label>
            <select id="critRisk" class="rating-select">
              <option value="0.5">Strong (0.5)</option>
              <option value="0.25">Partial (0.25)</option>
              <option value="0">None (0)</option>
            </select>
          </div>
        </div>
        <textarea id="notesRisk" class="notes-input" placeholder="Notes (optional)"></textarea>
      </div>
    </div>

    <!-- TOTALS + ACTIONS -->
    <div class="totals" aria-live="polite">
      <div class="totals-row">
        <span class="total-label">Raw weighted total (max 9.5)</span>
        <span class="total-value" id="weightedTotal">9.5 / 9.5</span>
      </div>
      <div class="final-total">
        <span>
          <strong>Overall Score</strong> (0–10, normalized)
        </span>
        <span class="final-score" id="finalScore">10.0</span>
      </div>
      <div class="footer-actions">
        <button type="button" class="reset-btn" id="resetBtn">
          Reset scores to default
        </button>
        <button type="button" class="download-btn" id="downloadBtn">
          Download results (.txt)
        </button>
      </div>
      <p class="helper-text">
        Note: Raw max = 9.5 (sum of all weights). Overall score = (raw / 9.5) × 10.
      </p>
    </div>
  </div>

  <script>
    const MAX_WEIGHTED = 9.5;

    function updateScores() {
      const selects = document.querySelectorAll(".rating-select");
      let weighted = 0;

      selects.forEach(sel => {
        weighted += Number(sel.value) || 0;
      });

      const overall10 = (weighted / MAX_WEIGHTED) * 10;

      document.getElementById("weightedTotal").textContent =
        weighted.toFixed(2) + " / " + MAX_WEIGHTED.toFixed(2);
      document.getElementById("finalScore").textContent = overall10.toFixed(2);
    }

    function downloadResults() {
      const title =
        document.getElementById("proposalTitle").value.trim() || "Untitled proposal";

      const items = [
        {
          id: "critStrategic",
          label: "Strategic/College Impact",
          notesId: "notesStrategic",
        },
        {
          id: "critQM",
          label: "Alignment to QM Framework",
          notesId: "notesQM",
        },
        {
          id: "critFeasibility",
          label: "Feasibility & Project Plan",
          notesId: "notesFeasibility",
        },
        {
          id: "critRationale",
          label: "Student-Centered Rationale",
          notesId: "notesRationale",
        },
        {
          id: "critReadiness",
          label: "Readiness & Experience",
          notesId: "notesReadiness",
        },
        {
          id: "critDept",
          label: "Departmental Support",
          notesId: "notesDept",
        },
        {
          id: "critSustain",
          label: "Sustainability & Certification Path",
          notesId: "notesSustain",
        },
        {
          id: "critRisk",
          label: "Risk & Resource Fit",
          notesId: "notesRisk",
        },
      ];

      let weighted = 0;
      let text = "";
      text += "QM Proposal — Weighted Scoring Summary (0–10 Scale)\n";
      text += "===================================================\n\n";
      text += "Proposal title: " + title + "\n\n";

      text += "Criteria (values are already weighted):\n";
      items.forEach(item => {
        const sel = document.getElementById(item.id);
        const val = Number(sel.value) || 0;
        const notes = document.getElementById(item.notesId).value.trim();

        weighted += val;
        text += `- ${item.label}: ${val.toFixed(2)} points\n`;
        if (notes) {
          text += `  Notes: ${notes}\n`;
        }
      });

      const overall10 = (weighted / MAX_WEIGHTED) * 10;
      text += `\nRaw weighted total: ${weighted.toFixed(2)} / ${MAX_WEIGHTED.toFixed(
        2
      )}\n`;
      text += `Overall score: ${overall10.toFixed(2)} / 10\n`;

      const now = new Date();
      text += `\nRecorded on: ${now.toLocaleString()}\n`;

      const blob = new Blob([text], { type: "text/plain" });
      const url = URL.createObjectURL(blob);

      const safeTitle = title.replace(/[^a-z0-9\-]+/gi, "_").slice(0, 50) || "proposal";
      const filename = `proposal_weighted_0-10_${safeTitle}.txt`;

      const a = document.createElement("a");
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    function attachListeners() {
      document.querySelectorAll(".rating-select").forEach(sel => {
        sel.addEventListener("change", updateScores);
      });

      document.getElementById("resetBtn").addEventListener("click", () => {
        // Reset all to max values
        document.getElementById("critStrategic").value = "2";
        document.getElementById("critQM").value = "2";
        document.getElementById("critFeasibility").value = "1.5";
        document.getElementById("critRationale").value = "1";
        document.getElementById("critReadiness").value = "1";
        document.getElementById("critDept").value = "1";
        document.getElementById("critSustain").value = "0.5";
        document.getElementById("critRisk").value = "0.5";

        updateScores();
      });

      document.getElementById("downloadBtn").addEventListener("click", () => {
        updateScores();
        downloadResults();
      });
    }

    attachListeners();
    updateScores();
  </script>
</body>
</html>
